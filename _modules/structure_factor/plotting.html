<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>structure_factor.plotting &mdash; structure-factor  documentation</title>
      <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="../../_static/proof.css" type="text/css" />
      <link rel="stylesheet" href="../../_static/plot_directive.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
        <script src="../../_static/jquery.js"></script>
        <script src="../../_static/underscore.js"></script>
        <script src="../../_static/doctools.js"></script>
        <script src="../../_static/proof.js"></script>
    <script src="../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="../../index.html" class="icon icon-home"> structure-factor
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul>
<li class="toctree-l1"><a class="reference internal" href="../../hyperuniformity.html">Hyperuniformity</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../multiscale_estimators.html">Multiscale estimators</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../pair_correlation_function.html">Pair correlation function</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../point_pattern.html">Point pattern</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../point_processes.html">Point processes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../spatial_windows.html">Spatial windows</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../structure_factor.html">Structure factor</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../tapers.html">Tapers</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../tapered_estimators.html">Tapered estimators</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../tapered_estimators_isotropic.html">Tapered isotropic estimators</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../transforms.html">Transforms</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../utils.html">Utils</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../plotting.html">Plotting</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../bibliography/index.html">Bibliography</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">structure-factor</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../index.html" class="icon icon-home"></a> &raquo;</li>
          <li><a href="../index.html">Module code</a> &raquo;</li>
      <li>structure_factor.plotting</li>
      <li class="wy-breadcrumbs-aside">
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <h1>Source code for structure_factor.plotting</h1><div class="highlight"><pre>
<span></span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="kn">from</span> <span class="nn">structure_factor.utils</span> <span class="kn">import</span> <span class="n">_bin_statistics</span><span class="p">,</span> <span class="n">_sort_vectors</span>

<span class="c1"># plot functions</span>


<div class="viewcode-block" id="plot_poisson"><a class="viewcode-back" href="../../plotting.html#structure_factor.plotting.plot_poisson">[docs]</a><span class="k">def</span> <span class="nf">plot_poisson</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">axis</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s2">&quot;k&quot;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">10</span><span class="p">)),</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Poisson&quot;</span><span class="p">):</span>
    <span class="sa">r</span><span class="sd">&quot;&quot;&quot;Plot the pair correlation function :math:`g_{poisson}` and the structure factor :math:`S_{poisson}` corresponding to the Poisson point process.</span>

<span class="sd">    Args:</span>
<span class="sd">        x (numpy.ndarray): x coordinate.</span>

<span class="sd">        axis (plt.Axes): Axis on which to add the plot.</span>

<span class="sd">        c (str, optional): Color of the plot. see `matplotlib &lt;https://matplotlib.org/2.1.1/api/_as_gen/matplotlib.pyplot.plot.html&gt;`_ . Defaults to &quot;k&quot;.</span>

<span class="sd">        linestyle (tuple, optional): Linstyle of the plot. see `linestyle &lt;https://matplotlib.org/stable/gallery/lines_bars_and_markers/linestyles.html&gt;`_. Defaults to (0, (5, 10)).</span>

<span class="sd">        label (regexp, optional): Label of the plot. Defaults to &quot;Poisson&quot;.</span>

<span class="sd">    Returns:</span>
<span class="sd">        plt.Axes: Plot of the pair correlation function and the structure factor of the Poisson point process over ``x``.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">axis</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ones_like</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="n">c</span><span class="o">=</span><span class="n">c</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="n">linestyle</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="n">label</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">axis</span></div>


<div class="viewcode-block" id="plot_summary"><a class="viewcode-back" href="../../plotting.html#structure_factor.plotting.plot_summary">[docs]</a><span class="k">def</span> <span class="nf">plot_summary</span><span class="p">(</span>
    <span class="n">x</span><span class="p">,</span>
    <span class="n">y</span><span class="p">,</span>
    <span class="n">axis</span><span class="p">,</span>
    <span class="n">scale</span><span class="o">=</span><span class="s2">&quot;log&quot;</span><span class="p">,</span>
    <span class="n">label</span><span class="o">=</span><span class="sa">r</span><span class="s2">&quot;mean $\pm$ 3 $\cdot$ std&quot;</span><span class="p">,</span>
    <span class="n">fmt</span><span class="o">=</span><span class="s2">&quot;b&quot;</span><span class="p">,</span>
    <span class="n">ecolor</span><span class="o">=</span><span class="s2">&quot;r&quot;</span><span class="p">,</span>
    <span class="o">**</span><span class="n">binning_params</span>
<span class="p">):</span>
    <span class="sa">r</span><span class="sd">&quot;&quot;&quot;Loglog plot the summary results of :py:func:`~structure_factor.utils._bin_statistics` i.e., means and errors bars (3 standard deviations).</span>

<span class="sd">    Args:</span>
<span class="sd">        x (numpy.ndarray): x coordinate.</span>

<span class="sd">        y (numpy.ndarray): y coordinate.</span>

<span class="sd">        axis (plt.Axes): Axis on which to add the plot.</span>

<span class="sd">        label (regexp, optional):  Label of the plot. Defaults to r&quot;mean $\pm$ 3 $\cdot$ std&quot;.</span>

<span class="sd">    Returns:</span>
<span class="sd">        plt.Axes: Plot of the results of :py:meth:`~structure_factor.utils._bin_statistics` applied on ``x`` and ``y`` .</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">bin_centers</span><span class="p">,</span> <span class="n">bin_mean</span><span class="p">,</span> <span class="n">bin_std</span> <span class="o">=</span> <span class="n">_bin_statistics</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="o">**</span><span class="n">binning_params</span><span class="p">)</span>
    <span class="n">axis</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">bin_centers</span><span class="p">,</span> <span class="n">bin_mean</span><span class="p">,</span> <span class="s2">&quot;b.&quot;</span><span class="p">)</span>
    <span class="n">axis</span><span class="o">.</span><span class="n">errorbar</span><span class="p">(</span>
        <span class="n">bin_centers</span><span class="p">,</span>
        <span class="n">bin_mean</span><span class="p">,</span>
        <span class="n">yerr</span><span class="o">=</span><span class="mi">3</span> <span class="o">*</span> <span class="n">bin_std</span><span class="p">,</span>  <span class="c1"># 3 times the standard deviation</span>
        <span class="n">fmt</span><span class="o">=</span><span class="n">fmt</span><span class="p">,</span>
        <span class="n">lw</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
        <span class="n">ecolor</span><span class="o">=</span><span class="n">ecolor</span><span class="p">,</span>
        <span class="n">capsize</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span>
        <span class="n">capthick</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
        <span class="n">label</span><span class="o">=</span><span class="n">label</span><span class="p">,</span>
        <span class="n">zorder</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">axis</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">framealpha</span><span class="o">=</span><span class="mf">0.2</span><span class="p">)</span>
    <span class="n">axis</span><span class="o">.</span><span class="n">set_yscale</span><span class="p">(</span><span class="n">scale</span><span class="p">)</span>
    <span class="n">axis</span><span class="o">.</span><span class="n">set_xscale</span><span class="p">(</span><span class="n">scale</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">axis</span></div>


<div class="viewcode-block" id="plot_exact"><a class="viewcode-back" href="../../plotting.html#structure_factor.plotting.plot_exact">[docs]</a><span class="k">def</span> <span class="nf">plot_exact</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">axis</span><span class="p">,</span> <span class="n">label</span><span class="p">):</span>
    <span class="sa">r</span><span class="sd">&quot;&quot;&quot;Loglog plot of a callable function ``y`` evaluated on the vector ``x``.</span>

<span class="sd">    Args:</span>
<span class="sd">        x (numpy.ndarray): x coordinate.</span>

<span class="sd">        y (numpy.ndarray): y coordinate.</span>

<span class="sd">        axis (plt.Axes): Axis on which to add the plot.</span>

<span class="sd">        label (regexp, optional):  Label of the plot.</span>

<span class="sd">    Returns:</span>
<span class="sd">        plt.Axes: Plot of ``y`` with respect to ``x``.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">_sort_vectors</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
    <span class="n">axis</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="s2">&quot;g&quot;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="n">label</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">axis</span></div>


<div class="viewcode-block" id="plot_approximation"><a class="viewcode-back" href="../../plotting.html#structure_factor.plotting.plot_approximation">[docs]</a><span class="k">def</span> <span class="nf">plot_approximation</span><span class="p">(</span>
    <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">axis</span><span class="p">,</span> <span class="n">rasterized</span><span class="p">,</span> <span class="n">label</span><span class="p">,</span> <span class="n">color</span><span class="p">,</span> <span class="n">linestyle</span><span class="p">,</span> <span class="n">marker</span><span class="p">,</span> <span class="n">markersize</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="s2">&quot;log&quot;</span>
<span class="p">):</span>
    <span class="sa">r</span><span class="sd">&quot;&quot;&quot;Loglog plot of ``y`` w.r.t. ``x``.</span>

<span class="sd">    Args:</span>
<span class="sd">        x (numpy.ndarray): x coordinate.</span>

<span class="sd">        y (numpy.ndarray): y coordinate.</span>

<span class="sd">        axis (plt.Axes): Axis on which to add the plot.</span>

<span class="sd">        rasterized (bool): Rasterized option of `matlplotlib.plot &lt;https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.plot.html#:~:text=float-,rasterized,-bool&gt;`_.</span>

<span class="sd">        label (regexp, optional):  Label of the plot.</span>

<span class="sd">        color (matplotlib.color): Color of the plot. see `color &lt;https://matplotlib.org/2.1.1/api/_as_gen/matplotlib.pyplot.plot.html&gt;`_ .</span>

<span class="sd">        linestyle (tuple): Style of the plot. see `linestyle &lt;https://matplotlib.org/stable/gallery/lines_bars_and_markers/linestyles.html&gt;`_.</span>

<span class="sd">        marker (matplotlib.marker): Marker of `marker &lt;https://matplotlib.org/stable/api/markers_api.html&gt;`_.</span>
<span class="sd">        markersize (float): Marker size.</span>

<span class="sd">        scale(str, optional): Trigger between plot scales of `plt.Axes &lt;https://matplotlib.org/stable/api/_as_gen/matplotlib.axes.Axes.set_xscale.html&gt;`_. Defaults to `log`.</span>

<span class="sd">    Returns:</span>
<span class="sd">        plt.Axes: Loglog plot of ``y`` w.r.t. ``x``</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">axis</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
        <span class="n">x</span><span class="p">,</span>
        <span class="n">y</span><span class="p">,</span>
        <span class="n">color</span><span class="o">=</span><span class="n">color</span><span class="p">,</span>
        <span class="n">linestyle</span><span class="o">=</span><span class="n">linestyle</span><span class="p">,</span>
        <span class="n">marker</span><span class="o">=</span><span class="n">marker</span><span class="p">,</span>
        <span class="n">label</span><span class="o">=</span><span class="n">label</span><span class="p">,</span>
        <span class="n">markersize</span><span class="o">=</span><span class="n">markersize</span><span class="p">,</span>
        <span class="n">rasterized</span><span class="o">=</span><span class="n">rasterized</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">axis</span><span class="o">.</span><span class="n">set_yscale</span><span class="p">(</span><span class="n">scale</span><span class="p">)</span>
    <span class="n">axis</span><span class="o">.</span><span class="n">set_xscale</span><span class="p">(</span><span class="n">scale</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">axis</span></div>


<div class="viewcode-block" id="plot_estimation_showcase"><a class="viewcode-back" href="../../plotting.html#structure_factor.plotting.plot_estimation_showcase">[docs]</a><span class="k">def</span> <span class="nf">plot_estimation_showcase</span><span class="p">(</span>
    <span class="n">k_norm</span><span class="p">,</span>
    <span class="n">estimation</span><span class="p">,</span>
    <span class="n">axis</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">scale</span><span class="o">=</span><span class="s2">&quot;log&quot;</span><span class="p">,</span>
    <span class="n">exact_sf</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">error_bar</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="n">label</span><span class="o">=</span><span class="sa">r</span><span class="s2">&quot;$\widehat</span><span class="si">{S}</span><span class="s2">$&quot;</span><span class="p">,</span>
    <span class="n">rasterized</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">file_name</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">,</span>
    <span class="o">**</span><span class="n">binning_params</span>
<span class="p">):</span>
    <span class="sa">r</span><span class="sd">&quot;&quot;&quot;Loglog plot of the results of the scattering intensity :py:meth:`~structure_factor.structure_factor.StructureFactor.scattering_intensity`, with the means and error bars over specific number of bins found via :py:func:`~structure_factor.utils._bin_statistics`.</span>

<span class="sd">    Args:</span>
<span class="sd">        k_norm (numpy.ndarray): Wavenumbers.</span>

<span class="sd">        estimation (numpy.ndarray): Scattering intensity corresponding to ``k_norm``.</span>

<span class="sd">        axis (plt.Axes, optional): Axis on which to add the plot. Defaults to None.</span>

<span class="sd">        scale(str, optional): Trigger between plot scales of `matplotlib.plot &lt;https://matplotlib.org/stable/api/_as_gen/matplotlib.axes.Axes.set_xscale.html&gt;`_. Defaults to `log`.</span>


<span class="sd">        exact_sf (callable, optional): Structure factor of the point process. Defaults to None.</span>

<span class="sd">        error_bar (bool, optional): If ``True``, ``k_norm`` and correspondingly ``estimation`` are divided into sub-intervals (bins). Over each bin, the mean and the standard deviation of ``estimation`` are derived and visualized on the plot. Note that each error bar corresponds to the mean +/- 3 standard deviation. To specify the number of bins, add it to the kwargs argument ``binning_params``. For more details see :py:meth:`~structure_factor.utils._bin_statistics`. Defaults to False.</span>

<span class="sd">        rasterized (bool, optional): Rasterized option of `matlplotlib.plot &lt;https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.plot.html#:~:text=float-,rasterized,-bool&gt;`_. Defaults to True.</span>

<span class="sd">        file_name (str, optional): Name used to save the figure. The available output formats depend on the backend being used. Defaults to &quot;&quot;.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">k_norm</span> <span class="o">=</span> <span class="n">k_norm</span><span class="o">.</span><span class="n">ravel</span><span class="p">()</span>
    <span class="n">estimation</span> <span class="o">=</span> <span class="n">estimation</span><span class="o">.</span><span class="n">ravel</span><span class="p">()</span>
    <span class="k">if</span> <span class="n">axis</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">_</span><span class="p">,</span> <span class="n">axis</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
    <span class="n">plot_approximation</span><span class="p">(</span>
        <span class="n">k_norm</span><span class="p">,</span>
        <span class="n">estimation</span><span class="p">,</span>
        <span class="n">axis</span><span class="o">=</span><span class="n">axis</span><span class="p">,</span>
        <span class="n">label</span><span class="o">=</span><span class="n">label</span><span class="p">,</span>
        <span class="n">color</span><span class="o">=</span><span class="s2">&quot;grey&quot;</span><span class="p">,</span>
        <span class="n">linestyle</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">,</span>
        <span class="n">marker</span><span class="o">=</span><span class="s2">&quot;.&quot;</span><span class="p">,</span>
        <span class="n">markersize</span><span class="o">=</span><span class="mf">1.5</span><span class="p">,</span>
        <span class="n">rasterized</span><span class="o">=</span><span class="n">rasterized</span><span class="p">,</span>
        <span class="n">scale</span><span class="o">=</span><span class="n">scale</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">plot_poisson</span><span class="p">(</span><span class="n">k_norm</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="n">axis</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">error_bar</span><span class="p">:</span>
        <span class="n">plot_summary</span><span class="p">(</span><span class="n">k_norm</span><span class="p">,</span> <span class="n">estimation</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="n">axis</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="n">scale</span><span class="p">,</span> <span class="o">**</span><span class="n">binning_params</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">exact_sf</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">plot_exact</span><span class="p">(</span><span class="n">k_norm</span><span class="p">,</span> <span class="n">exact_sf</span><span class="p">(</span><span class="n">k_norm</span><span class="p">),</span> <span class="n">axis</span><span class="o">=</span><span class="n">axis</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">r</span><span class="s2">&quot;Exact $S(\mathbf</span><span class="si">{k}</span><span class="s2">)$&quot;</span><span class="p">)</span>

    <span class="n">axis</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;Wavenumber ($||\mathbf</span><span class="si">{k}</span><span class="s2">||$)&quot;</span><span class="p">)</span>
    <span class="n">axis</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;Structure factor ($S(\mathbf</span><span class="si">{k}</span><span class="s2">)$)&quot;</span><span class="p">)</span>
    <span class="n">axis</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">framealpha</span><span class="o">=</span><span class="mf">0.2</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">file_name</span><span class="p">:</span>
        <span class="n">fig</span> <span class="o">=</span> <span class="n">axis</span><span class="o">.</span><span class="n">get_figure</span><span class="p">()</span>
        <span class="n">fig</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">file_name</span><span class="p">,</span> <span class="n">bbox_inches</span><span class="o">=</span><span class="s2">&quot;tight&quot;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">axis</span></div>


<div class="viewcode-block" id="plot_estimation_imshow"><a class="viewcode-back" href="../../plotting.html#structure_factor.plotting.plot_estimation_imshow">[docs]</a><span class="k">def</span> <span class="nf">plot_estimation_imshow</span><span class="p">(</span><span class="n">k_norm</span><span class="p">,</span> <span class="n">si</span><span class="p">,</span> <span class="n">axis</span><span class="p">,</span> <span class="n">file_name</span><span class="p">):</span>
    <span class="sa">r</span><span class="sd">&quot;&quot;&quot;Color level 2D plot, centered on zero.</span>

<span class="sd">    Args:</span>
<span class="sd">        k_norm (numpy.ndarray): Wavenumbers.</span>

<span class="sd">        si (numpy.ndarray): Scattering intensity corresponding to ``k_norm``.</span>

<span class="sd">        axis (plt.Axes): Axis on which to add the plot.</span>

<span class="sd">        file_name (str, optional): Name used to save the figure. The available output formats depend on the backend being used. Defaults to &quot;&quot;.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">axis</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">_</span><span class="p">,</span> <span class="n">axis</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">k_norm</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">2</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
            <span class="s2">&quot;the scattering intensity should be evaluated on a meshgrid or choose plot_type = &#39;plot&#39;. &quot;</span>
        <span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">log_si</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">si</span><span class="p">)</span>
        <span class="n">m</span><span class="p">,</span> <span class="n">n</span> <span class="o">=</span> <span class="n">log_si</span><span class="o">.</span><span class="n">shape</span>
        <span class="n">m</span> <span class="o">/=</span> <span class="mi">2</span>
        <span class="n">n</span> <span class="o">/=</span> <span class="mi">2</span>
        <span class="n">f_0</span> <span class="o">=</span> <span class="n">axis</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span>
            <span class="n">log_si</span><span class="p">,</span>
            <span class="n">extent</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="n">n</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="o">-</span><span class="n">m</span><span class="p">,</span> <span class="n">m</span><span class="p">],</span>
            <span class="n">cmap</span><span class="o">=</span><span class="s2">&quot;PRGn&quot;</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">f_0</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">axis</span><span class="p">)</span>
        <span class="c1"># axis.title.set_text(&quot;Scattering intensity&quot;)</span>

        <span class="k">if</span> <span class="n">file_name</span><span class="p">:</span>
            <span class="n">fig</span> <span class="o">=</span> <span class="n">axis</span><span class="o">.</span><span class="n">get_figure</span><span class="p">()</span>
            <span class="n">fig</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">file_name</span><span class="p">,</span> <span class="n">bbox_inches</span><span class="o">=</span><span class="s2">&quot;tight&quot;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">axis</span></div>


<div class="viewcode-block" id="plot_estimation_all"><a class="viewcode-back" href="../../plotting.html#structure_factor.plotting.plot_estimation_all">[docs]</a><span class="k">def</span> <span class="nf">plot_estimation_all</span><span class="p">(</span>
    <span class="n">point_pattern</span><span class="p">,</span>
    <span class="n">k_norm</span><span class="p">,</span>
    <span class="n">estimation</span><span class="p">,</span>
    <span class="n">exact_sf</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">error_bar</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="n">label</span><span class="o">=</span><span class="sa">r</span><span class="s2">&quot;$\widehat</span><span class="si">{S}</span><span class="s2">$&quot;</span><span class="p">,</span>
    <span class="n">rasterized</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">file_name</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">,</span>
    <span class="n">window_res</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">scale</span><span class="o">=</span><span class="s2">&quot;log&quot;</span><span class="p">,</span>
    <span class="o">**</span><span class="n">binning_params</span>
<span class="p">):</span>
    <span class="sa">r</span><span class="sd">&quot;&quot;&quot;Construct 3 subplots: point pattern, associated scattering intensity plot, associated scattering intensity color level (only for 2D point processes).</span>

<span class="sd">    Args:</span>
<span class="sd">        point_pattern (:py:class:`~structure_factor.point_pattern.PointPattern`): Object of type PointPattern containing a realization ``point_pattern.points`` of a point process, the window where the points were simulated ``point_pattern.window`` and (optionally) the intensity of the point process ``point_pattern.intensity``.</span>

<span class="sd">        k_norm (numpy.ndarray): Wavenumbers.</span>

<span class="sd">        estimation (numpy.ndarray): Scattering intensity corresponding to ``k_norm``.</span>

<span class="sd">        exact_sf (callable, optional): Structure factor of the point process. Defaults to None.</span>

<span class="sd">        error_bar (bool, optional): If ``True``, ``k_norm`` and correspondingly ``estimation`` are divided into sub-intervals (bins). Over each bin, the mean and the standard deviation of ``estimation`` are derived and visualized on the plot. Note that each error bar corresponds to the mean +/- 3 standard deviation. To specify the number of bins, add it to the kwargs argument ``binning_params``. For more details see :py:meth:`~structure_factor.utils._bin_statistics`. Defaults to False.</span>

<span class="sd">        rasterized (bool, optional): Rasterized option of `matlplotlib.plot &lt;https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.plot.html#:~:text=float-,rasterized,-bool&gt;`_. Defaults to True.</span>

<span class="sd">        file_name (str, optional): Name used to save the figure. The available output formats depend on the backend being used. Defaults to &quot;&quot;.</span>

<span class="sd">        window_res (:py:class:`~structure_factor.spatial_windows.AbstractSpatialWindow`, optional): New restriction window. It is useful when the sample of points is large, so for time and visualization purposes, it is better to restrict the plot of the point process to a smaller window. Defaults to None.</span>

<span class="sd">        scale(str, optional): Trigger between plot scales of `matplotlib.plot &lt;https://matplotlib.org/stable/api/_as_gen/matplotlib.axes.Axes.set_xscale.html&gt;`_. Defaults to `log`.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">figure</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">24</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>

    <span class="n">point_pattern</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">window</span><span class="o">=</span><span class="n">window_res</span><span class="p">)</span>
    <span class="n">plot_estimation_showcase</span><span class="p">(</span>
        <span class="n">k_norm</span><span class="p">,</span>
        <span class="n">estimation</span><span class="p">,</span>
        <span class="n">axis</span><span class="o">=</span><span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span>
        <span class="n">exact_sf</span><span class="o">=</span><span class="n">exact_sf</span><span class="p">,</span>
        <span class="n">error_bar</span><span class="o">=</span><span class="n">error_bar</span><span class="p">,</span>
        <span class="n">label</span><span class="o">=</span><span class="n">label</span><span class="p">,</span>
        <span class="n">rasterized</span><span class="o">=</span><span class="n">rasterized</span><span class="p">,</span>
        <span class="n">file_name</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">,</span>
        <span class="n">scale</span><span class="o">=</span><span class="n">scale</span><span class="p">,</span>
        <span class="o">**</span><span class="n">binning_params</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">plot_estimation_imshow</span><span class="p">(</span><span class="n">k_norm</span><span class="p">,</span> <span class="n">estimation</span><span class="p">,</span> <span class="n">axes</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">file_name</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">file_name</span><span class="p">:</span>
        <span class="n">figure</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">file_name</span><span class="p">,</span> <span class="n">bbox_inches</span><span class="o">=</span><span class="s2">&quot;tight&quot;</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">axes</span></div>


<div class="viewcode-block" id="plot_sf_hankel_quadrature"><a class="viewcode-back" href="../../plotting.html#structure_factor.plotting.plot_sf_hankel_quadrature">[docs]</a><span class="k">def</span> <span class="nf">plot_sf_hankel_quadrature</span><span class="p">(</span>
    <span class="n">k_norm</span><span class="p">,</span>
    <span class="n">estimation</span><span class="p">,</span>
    <span class="n">axis</span><span class="p">,</span>
    <span class="n">scale</span><span class="p">,</span>
    <span class="n">k_norm_min</span><span class="p">,</span>
    <span class="n">exact_sf</span><span class="p">,</span>
    <span class="n">color</span><span class="p">,</span>
    <span class="n">error_bar</span><span class="p">,</span>
    <span class="n">label</span><span class="p">,</span>
    <span class="n">file_name</span><span class="p">,</span>
    <span class="o">**</span><span class="n">binning_params</span>
<span class="p">):</span>
    <span class="sa">r</span><span class="sd">&quot;&quot;&quot;Plot the approximations of the structure factor (results of :py:meth:`~structure_factor.structure_factor.StructureFactor.quadrature_estimator_isotropic`) with means and error bars over bins, see :py:meth:`~structure_factor.utils._bin_statistics`.</span>

<span class="sd">    Args:</span>
<span class="sd">        k_norm (numpy.ndarray): Vector of wavenumbers (i.e., norms of waves) on which the structure factor has been approximated.</span>

<span class="sd">        estimation (numpy.ndarray): Approximation of the structure factor corresponding to ``k_norm``.</span>

<span class="sd">        axis (plt.Axes): Support axis of the plots.</span>

<span class="sd">        scale(str): Trigger between plot scales of `matplotlib.plot &lt;https://matplotlib.org/stable/api/_as_gen/matplotlib.axes.Axes.set_xscale.html&gt;`_.</span>

<span class="sd">        k_norm_min (float): Estimated lower bound of the wavenumbers (only when ``estimation`` was approximated using **Ogata quadrature**).</span>

<span class="sd">        exact_sf (callable): Theoretical structure factor of the point process.</span>

<span class="sd">        error_bar (bool): If ``True``, ``k_norm`` and correspondingly ``si`` are divided into sub-intervals (bins). Over each bin, the mean and the standard deviation of ``si`` are derived and visualized on the plot. Note that each error bar corresponds to the mean +/- 3 standard deviation. To specify the number of bins, add it to the kwargs argument ``binning_params``. For more details see :py:meth:`~structure_factor.utils._bin_statistics`. Defaults to False.</span>

<span class="sd">        file_name (str): Name used to save the figure. The available output formats depend on the backend being used.</span>

<span class="sd">        label (regexp):  Label of the plot.</span>

<span class="sd">    Keyword Args:</span>
<span class="sd">        binning_params: (dict): Used when ``error_bar=True``, by the method :py:meth:`~structure_factor.utils_bin_statistics` as keyword arguments (except ``&quot;statistic&quot;``) of ``scipy.stats.binned_statistic``.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">axis</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">fig</span><span class="p">,</span> <span class="n">axis</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>

    <span class="n">plot_approximation</span><span class="p">(</span>
        <span class="n">k_norm</span><span class="p">,</span>
        <span class="n">estimation</span><span class="p">,</span>
        <span class="n">axis</span><span class="o">=</span><span class="n">axis</span><span class="p">,</span>
        <span class="n">label</span><span class="o">=</span><span class="n">label</span><span class="p">,</span>
        <span class="n">marker</span><span class="o">=</span><span class="s2">&quot;.&quot;</span><span class="p">,</span>
        <span class="n">linestyle</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">,</span>
        <span class="n">color</span><span class="o">=</span><span class="n">color</span><span class="p">,</span>
        <span class="n">markersize</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span>
        <span class="n">scale</span><span class="o">=</span><span class="n">scale</span><span class="p">,</span>
        <span class="n">rasterized</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="k">if</span> <span class="n">exact_sf</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">plot_exact</span><span class="p">(</span><span class="n">k_norm</span><span class="p">,</span> <span class="n">exact_sf</span><span class="p">(</span><span class="n">k_norm</span><span class="p">),</span> <span class="n">axis</span><span class="o">=</span><span class="n">axis</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">r</span><span class="s2">&quot;Exact $S(k)$&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">error_bar</span><span class="p">:</span>
        <span class="n">plot_summary</span><span class="p">(</span><span class="n">k_norm</span><span class="p">,</span> <span class="n">estimation</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="n">axis</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="n">scale</span><span class="p">,</span> <span class="o">**</span><span class="n">binning_params</span><span class="p">)</span>
    <span class="n">plot_poisson</span><span class="p">(</span><span class="n">k_norm</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="n">axis</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">k_norm_min</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">sf_interpolate</span> <span class="o">=</span> <span class="n">interpolate</span><span class="o">.</span><span class="n">interp1d</span><span class="p">(</span>
            <span class="n">k_norm</span><span class="p">,</span> <span class="n">estimation</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">fill_value</span><span class="o">=</span><span class="s2">&quot;extrapolate&quot;</span><span class="p">,</span> <span class="n">kind</span><span class="o">=</span><span class="s2">&quot;cubic&quot;</span>
        <span class="p">)</span>
        <span class="n">axis</span><span class="o">.</span><span class="n">loglog</span><span class="p">(</span>
            <span class="n">k_norm_min</span><span class="p">,</span>
            <span class="n">sf_interpolate</span><span class="p">(</span><span class="n">k_norm_min</span><span class="p">),</span>
            <span class="s2">&quot;ro&quot;</span><span class="p">,</span>
            <span class="n">label</span><span class="o">=</span><span class="sa">r</span><span class="s2">&quot;$k_</span><span class="si">{min}</span><span class="s2">$&quot;</span><span class="p">,</span>
        <span class="p">)</span>
    <span class="n">axis</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
    <span class="n">axis</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;Wavenumber ($k$)&quot;</span><span class="p">)</span>
    <span class="n">axis</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;Structure factor ($S(k)$)&quot;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
    <span class="k">if</span> <span class="n">file_name</span><span class="p">:</span>
        <span class="n">fig</span> <span class="o">=</span> <span class="n">axis</span><span class="o">.</span><span class="n">get_figure</span><span class="p">()</span>
        <span class="n">fig</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">file_name</span><span class="p">,</span> <span class="n">bbox_inches</span><span class="o">=</span><span class="s2">&quot;tight&quot;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">axis</span></div>
</pre></div>

           </div>
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2021-2022, Diala Hawat.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>